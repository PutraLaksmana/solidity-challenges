// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "forge-std/Test.sol";
import {Mimic} from "src/exploits/mimic/Mimic.sol";

contract MimicTest is Test {
    Mimic public mimic;
    address public challenger = vm.addr(1);

    uint256 public contractBalance = 50 ether;
    uint256 public initialChallengerBalance = 1 ether;

    function setUp() public {
        mimic = new Mimic();
        payable(address(mimic)).transfer(contractBalance);

        vm.deal(challenger, initialChallengerBalance);
    }

    function testPreCheck() public view {
        assertEq(address(mimic).balance, contractBalance);
        assertEq(address(challenger).balance, initialChallengerBalance);
    }

    function testAttack() public {
        uint256 initialBalance = challenger.balance;
        vm.startPrank(challenger);

        /* 

        Write the code to explot the vault here

        */

        // DO NOT REMOVE
        uint256 expectedBalance = initialBalance + contractBalance;
        assertEq(challenger.balance, expectedBalance);
        assertEq(address(mimic).balance, 0);
    }
}
